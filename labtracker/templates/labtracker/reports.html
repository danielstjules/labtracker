{% extends 'base.html' %} 
{% block title %}labtracker | Generate Reports{% endblock %}
{% block h1_title %}<h1>Reports</h1>{% endblock %}

{% block content %}

{% if user.is_staff %}
	<h2>Generate Reports</h2>
	<form action="{{ req.get_post_comment_url }}" method="post" class="reports_form">
		{% csrf_token %}
		<p>
			Specify the range of dates used in building the Excel sheet. All 
			requests within that range will be used in creating the file. <br />
			Feel free to use the shortcuts we've provided, or specify the two dates
			individually.
		</p>
		<div class="fl left_col">
			<strong>Specify two dates:</strong><br />
			<label for="startdate">Start date:</label>
			<input type="date" name="startdate"><br />
			<label for="enddate">End date:</label>
			<input type="date" name="enddate"><br /><br />
			<strong>And submit to generate:</strong><br />
			<input type="submit" value="Generate Report" />
		</div>
		<strong>Or select from a common range:</strong><br />
		<select name="timelength" id="timelength">
			<option value="past7days">Past 7 Days</option>
			<option value="past30days">Past 30 Days</option>
			<option value="past60days">Past 60 Days</option>
			<option value="past90days">Past 90 Days</option>
			<option value="past365days">Past 365 Days</option>
			<option value="thismonth">This Week</option>
			<option value="thismonth">This Month</option>
			<option value="thisyear">This Year</option>
			<option value="alltime">All Time</option>
		</select><br /><br />
	</form>
	<h2>All Reports</h2>
	{% if report_list %}
		<table id="report_list" summary="Report List">
		<thead>
			<tr>
				<th scope="col">Generated By</th>
				<th scope="col">On</th>
				<th scope="col">Description</th>
				<th scope="col"></th>
				<th scope="col"></th>
			</tr>
		</thead>
		<tbody>
		{% for report in report_list %}
				<tr>
					<td>{{ report.user }}</td>
					<td>{{ report.date_created }}</td>
					<td>{{ report.description }}</td>
					<td><a href="{{ MEDIA_URL }}{{ report.rfile }}">Download</a></td>
					<td><a href="{{ report.get_delete_url }}">Delete</a></td>
				</tr>
		{% endfor %}
		</tbody>
		</table>
	{% else %}
		<p>You have not generated any reports.</p>
	{% endif %}
{% else %}
	<p>You need to be an admin to view this page.</p>
{% endif %}

{% endblock %}
